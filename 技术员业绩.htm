<!DOCTYPE html>
<html>
<head>
	<meta charset="gb2312">
	<meta content="widspan=device-widspan,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
	<meta content="yes" name="apple-mobile-web-app-capable">
	<meta content="black" name="apple-mobile-web-app-status-bar-style">
	<meta content="telephone=no" name="format-detection">
	<meta content="email=no" name="format-detection">
	<title>城市经理OA系统</title>
	<link rel="stylesheet" href="css/style.css">

</head>
<body>
<div class="wrapper pb150">
	<!-- header -->
	<section class="header"><div class="tc">技术员业绩</div></section>
	<!-- header end -->
	<!--main-->

	<div class="searchBox">
		<div class="searchBoxL">
			<div class="searchBoxL_L">手机号码</div>
			<div class="searchBoxL_Z"><input type="text"><i class="del" style="display:block;"></i></div>
		</div>
		<a class="btnSearch" href="">搜 索</a>
		<div class="ml25 sifting"><span>筛选</span></div>
	</div>
	<a class="TitleA arrowR mb20 lineTop lineDown" href="#">
		<p class="TitleA_Z cBlue">KA大客户业绩</p>
	</a>
	<ul class="navUl">
		<li><a class="checked" href="#">手机业绩</a></li>
		<li><a href="#">电脑业绩</a></li>
	</ul>
	<div class="dateBox">
		<div class="dateBoxL">
			<em id="yearMonth">2016-03-02</em>
			<a class="dateA ml40" id="checkDate" href="javascript:;">选择日期</a>
			<a class="dateA ml40" id="checkMonth" href="javascript:;">选择月份</a>
		</div>
	</div>
	<div class="J_Box">
			<div class="tableB">
				<div>
					<div class="table_title" id="title">
						<span>用户名</span>
						<span class="span1">手机收入(元)</span>
						<span>手机激活</span>
						<span>安卓激活</span>
						<span>苹果到达</span>
					</div>
				</div>
				<div class="table_tr" href="#">
					<span>当日汇总</span>
					<span class="span1">3400</span>
					<span>2300</span>
					<span>320</span>
					<span>300</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_4</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_4</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
				<div class="table_tr" href="#">
					<span><a href="#">手机用户_45 37727687</a></span>
					<span class="span1">34</span>
					<span>24</span>
					<span>48</span>
					<span>12</span>
				</div>
			</div>
	</div>
	<!--main end-->
</div>
<!-- 固定底部nav -->
<div class="nav_footer">
	<a class="home" href="#">首页</a>
	<a class="introduce" href="#">录入技术员</a>
	<a class="record checked" href="#">技术员业绩</a>
	<a class="Packingbox" href="#">装机盒子</a>
	<a class="mores" href="#">我的</a>
</div>
<script type="text/javascript" src="js/zepto.min.js"></script>
<script src="js/picker.min.js"></script>
<script src="js/biaotfix.js"></script>
<script type="text/javascript">
/*日期开始*/
var $month = $('#checkMonth');
var $date = $('#checkDate');
var data1=[];
var data2=[];
var data3=[];

var startYear = 2015;

var myDate = new Date();
var nowYear = myDate.getFullYear(); //获取完整的年份(4位,1970-????)
var nowMonth = myDate.getMonth(); //获取当前月份(0-11,0代表1月)


var data = [data1,data2,data3]
var maxDay = 31;
var arr_1 = $("#yearMonth").text().split("-");
if(!arr_1[2]){
	arr_1[2]=1;
}
if(arr_1[1]==1 || arr_1[1]==3|| arr_1[1]==5|| arr_1[1]==7|| arr_1[1]==8|| arr_1[1]==10|| arr_1[1]==12){
	maxDay = 31
}else if(arr_1[1]==2){
	if(arr_1[0]%4==0){
		maxDay = 29
	}else{
		maxDay = 28
	}
	
}else{
	maxDay = 30
}

for(var i =0;i<= Math.floor(nowYear-startYear);i++){
	data1.push({
		text:startYear+i+'年',
		value:arr_1[1]
	})
}

for(var i =0;i< 12;i++){
	var s= startYear;
	data2.push({
		text:i+1+'月',
		value:arr_1[0]
	})
}

for(var i =0;i< maxDay;i++){
	data3.push({
		text:i+1+'日'
	})
}



$month.picker({
	data: [data1, data2],
	selectIndex: [Math.floor(arr_1[0]-startYear), Math.floor(arr_1[1]-1)]

}).on('picker.select', function (e, selectVal, selectIndex) {

	var year = getNum(data1[selectIndex[0]].text)
	var month = getNum(data2[selectIndex[1]].text)

	month = month >=10 ? month : "0"+month
	$("#yearMonth").text( year+ '-' + month );


})

$date.picker({
	data: [data1, data2, data3],
	selectIndex: [Math.floor(arr_1[0]-startYear), Math.floor(arr_1[1]-1), Math.floor(arr_1[2]-1)]

}).on('picker.select', function (e, selectVal, selectIndex) {
	

	var year = getNum(data1[selectIndex[0]].text)
	var month = getNum(data2[selectIndex[1]].text)
	var date = getNum(data3[selectIndex[2]].text)
	var maxday = 31;

	//
	if(month==2){
		if(year%4==0){
			maxday=29;
		}else{
			maxday=28;
		}

		if(date > 28 && year%4==0){
			selectIndex[2]=28  //28即使29日

		}else if(date > 28 && year%4!=0){
			selectIndex[2]=27  //28日
		}

	}else if(month==4 || month==6 || month==9 || month==11){

		maxday=30;

		if(date > 30){
			selectIndex[2]=29  //30日
		}
	}

	year = getNum(data1[selectIndex[0]].text)
	month = getNum(data2[selectIndex[1]].text)
	date = getNum(data3[selectIndex[2]].text)


	data3 =[];
	for(var i=0;i<maxday;i++){
		data3.push({
			text:i+1+'日'
		})
	}
	//重填日期
	$date.picker('refill', data3, 2);
	selectIndex[2]=date-1;
	


	month = month >=10 ? month : "0"+month
	date = date >=10 ? date : "0"+date
	$("#yearMonth").text(year + '-' + month + '-' + date );

	

}).on('picker.change', function (e, index, selectIndex) {
	
	if(index==0){

		var year = getNum(data1[selectIndex].text)
		var moneth = data1[selectIndex].value
		data2 =[];
		for(var i=0;i<12;i++){
			data2.push({
				text:i+1+'月',
				value:year
			})
		}
		
		//重填月份
		//$date.picker('refill', data2, 1);		

		if(moneth==4 || moneth==6|| moneth==9|| moneth==11){
			maxDay = 30
		}else if(moneth==2){

			if(year%4==0){
				maxDay = 29
			}else{
				maxDay = 28
			}
			
		}else{
			maxDay = 31
		}

		if(data3.length !=maxDay){
			data3 =[];
			for(var i=0;i<maxDay;i++){
				data3.push({
					text:i+1+'日'
				})
			}
			//重填日期
			$date.picker('refill', data3, 2);
		}

	


	}else if(index==1){

		var year = data2[selectIndex].value
		var month =getNum(data2[selectIndex].text)
		
		data1=[];
		for(var i =0;i<= Math.floor(nowYear-startYear);i++){
			data1.push({
				text:startYear+i+'年',
				value:month
			})
		}

		if(month==1 || month==3|| month==5|| month==7|| month==8|| month==10|| month==12){
			
			if(data3.length!=31){
				data3 = [];
				for(var i =0;i< 31;i++){
					data3.push({
						text:i+1+'日'
					})
				}
				//重填日期
				$date.picker('refill', data3, 2);
			}
			
			
		}else if(month==4 || month==6 || month==9 || month==11){
			if(data3.length!=30){
				data3 = [];
				for(var i =0;i< 30;i++){
					data3.push({
						text:i+1+'日'
					})
				}
				//重填日期
				$date.picker('refill', data3, 2);
			}
			
		}else if(month==2){
			
			var num = 28;
			if(year%4==0){
				num = 29
			}

			if(data3.length!=num){

				data3 = [];
				for(var i =0;i< num;i++){
					data3.push({
						text:i+1+'日'
					})
				}
				//重填日期
				$date.picker('refill', data3, 2);
			}

			
		}
		
	}

})

$month.on('click', function () {
	$(this).picker('show');
	

});
$date.on('click', function () {
	$(this).picker('show');
});


//取数字
function getNum(text){
	var value = text.replace(/[^0-9]/ig,""); 
	return value
}

/*日期end*/
</script>
<script type="text/javascript">
	document.body.addEventListener('touchstart', function(){})
</script>
<script type="text/javascript">
	$(function(){
		/*监听滚动事件 表头固定 begin*/
		$(document).on("scroll",function(){
			//if begin

			var Titlefix = document.getElementById("title");

			if (gtIOS6()) {
			    // 大于等于iOS6版本使用sticky
			    
			    Titlefix.parentNode.className='sticky';
			    

			} else {
				//安卓 和 小于ios6
				//收入支出表头
				fixTitle($("#title"),0,".J_Box",11)
			}
			//if end


		})
		/*监听滚动事件 表头固定 end*/



		
	})
</script>
</body>
</html>
